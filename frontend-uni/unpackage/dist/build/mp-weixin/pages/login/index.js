"use strict";const e=require("../../common/vendor.js"),o=require("../../api/auth.js"),s=require("../../common/assets.js"),n={data:()=>({form:{username:"",password:""},loading:!1}),methods:{async handleLogin(){if(this.form.username&&this.form.password){this.loading=!0;try{const s=await o.login(this.form);e.index.setStorageSync("token",s.token),e.index.setStorageSync("userInfo",s.userInfo),e.index.setStorageSync("roles",s.userInfo.roles||[]),e.index.showToast({title:"登录成功",icon:"success"}),setTimeout((()=>{e.index.reLaunch({url:"/pages/index/index"})}),1500)}catch(s){e.index.showToast({title:s.detail||"登录失败",icon:"none"})}finally{this.loading=!1}}else e.index.showToast({title:"请输入账号和密码",icon:"none"})}}};const t=e._export_sfc(n,[["render",function(o,n,t,a,i,r){return{a:s._imports_0$1,b:i.form.username,c:e.o((e=>i.form.username=e.detail.value)),d:i.form.password,e:e.o((e=>i.form.password=e.detail.value)),f:e.o(((...e)=>r.handleLogin&&r.handleLogin(...e))),g:i.loading}}],["__scopeId","data-v-e913a08f"]]);wx.createPage(t);
