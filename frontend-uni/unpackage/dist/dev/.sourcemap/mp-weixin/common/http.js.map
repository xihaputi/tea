{"version":3,"file":"http.js","sources":["common/http.js"],"sourcesContent":["const BASE_URL = process.env.UNI_APP_API_BASE || 'http://116.62.25.191:1112/api';\n\nconst request = (method, url, data = {}) =>\n  new Promise((resolve, reject) => {\n    const token = uni.getStorageSync('token');\n    const header = {};\n    if (token) {\n      header['Authorization'] = token;\n    }\n\n    uni.request({\n      url: `${BASE_URL}${url}`,\n      method,\n      data,\n      header,\n      success: (res) => {\n        if (res.statusCode >= 200 && res.statusCode < 300) {\n          resolve(res.data);\n        } else if (res.statusCode === 401) {\n          uni.removeStorageSync('token');\n          uni.showToast({ title: '���ȵ�¼', icon: 'none' });\n          reject(res);\n        } else {\n          reject(res);\n        }\n      },\n      fail: reject,\n    });\n  });\n\nconst upload = (url, filePath, name = 'file', formData = {}) =>\n  new Promise((resolve, reject) => {\n    const token = uni.getStorageSync('token');\n    const header = {};\n    if (token) {\n      header['Authorization'] = token;\n    }\n\n    uni.uploadFile({\n      url: `${BASE_URL}${url}`,\n      filePath,\n      name,\n      formData,\n      header,\n      success: (res) => {\n        if (res.statusCode >= 200 && res.statusCode < 300) {\n          resolve(JSON.parse(res.data));\n        } else {\n          reject(res);\n        }\n      },\n      fail: reject,\n    });\n  });\n\nexport const api = {\n  get: (url, data) => request('GET', url, data),\n  post: (url, data) => request('POST', url, data),\n  put: (url, data) => request('PUT', url, data),\n  delete: (url, data) => request('DELETE', url, data),\n  upload,\n};\n\n"],"names":["uni"],"mappings":";;AAAA,MAAM,WAAW,QAAQ,IAAI,oBAAoB;AAEjD,MAAM,UAAU,CAAC,QAAQ,KAAK,OAAO,CAAE,MACrC,IAAI,QAAQ,CAAC,SAAS,WAAW;AAC/B,QAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,QAAM,SAAS,CAAA;AACf,MAAI,OAAO;AACT,WAAO,eAAe,IAAI;AAAA,EAC3B;AAEDA,gBAAAA,MAAI,QAAQ;AAAA,IACV,KAAK,GAAG,QAAQ,GAAG,GAAG;AAAA,IACtB;AAAA,IACA;AAAA,IACA;AAAA,IACA,SAAS,CAAC,QAAQ;AAChB,UAAI,IAAI,cAAc,OAAO,IAAI,aAAa,KAAK;AACjD,gBAAQ,IAAI,IAAI;AAAA,MAC1B,WAAmB,IAAI,eAAe,KAAK;AACjCA,4BAAI,kBAAkB,OAAO;AAC7BA,sBAAG,MAAC,UAAU,EAAE,OAAO,UAAU,MAAM,OAAM,CAAE;AAC/C,eAAO,GAAG;AAAA,MACpB,OAAe;AACL,eAAO,GAAG;AAAA,MACX;AAAA,IACF;AAAA,IACD,MAAM;AAAA,EACZ,CAAK;AACL,CAAG;AAEH,MAAM,SAAS,CAAC,KAAK,UAAU,OAAO,QAAQ,WAAW,CAAE,MACzD,IAAI,QAAQ,CAAC,SAAS,WAAW;AAC/B,QAAM,QAAQA,cAAAA,MAAI,eAAe,OAAO;AACxC,QAAM,SAAS,CAAA;AACf,MAAI,OAAO;AACT,WAAO,eAAe,IAAI;AAAA,EAC3B;AAEDA,gBAAAA,MAAI,WAAW;AAAA,IACb,KAAK,GAAG,QAAQ,GAAG,GAAG;AAAA,IACtB;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA,SAAS,CAAC,QAAQ;AAChB,UAAI,IAAI,cAAc,OAAO,IAAI,aAAa,KAAK;AACjD,gBAAQ,KAAK,MAAM,IAAI,IAAI,CAAC;AAAA,MACtC,OAAe;AACL,eAAO,GAAG;AAAA,MACX;AAAA,IACF;AAAA,IACD,MAAM;AAAA,EACZ,CAAK;AACL,CAAG;AAES,MAAC,MAAM;AAAA,EACjB,KAAK,CAAC,KAAK,SAAS,QAAQ,OAAO,KAAK,IAAI;AAAA,EAC5C,MAAM,CAAC,KAAK,SAAS,QAAQ,QAAQ,KAAK,IAAI;AAAA,EAC9C,KAAK,CAAC,KAAK,SAAS,QAAQ,OAAO,KAAK,IAAI;AAAA,EAC5C,QAAQ,CAAC,KAAK,SAAS,QAAQ,UAAU,KAAK,IAAI;AAAA,EAClD;AACF;;"}