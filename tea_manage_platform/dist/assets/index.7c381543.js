import{_ as s,l as e}from"./index.e41e9f95.js";import{u as a,e as l,f as o,r,o as n,i as t,j as i,a as u,w as d,l as c,n as p,O as m,E as g}from"./vendor.da7b8729.js";const f={class:"login-container"},v={class:"login-card animate-up"},_={class:"footer-links"},w={__name:"index",setup(w){const k=a(),h=l(!1),y=o({username:"",password:""}),I=async()=>{var s,a,l,o;if(!y.username||!y.password)return g.warning("请输入账号和密码");h.value=!0;try{const l=await e({username:y.username,password:y.password});console.log("Login response:",l),l&&l.token?(localStorage.setItem("tea_token",l.token),localStorage.setItem("tea_roles",JSON.stringify((null==(s=l.userInfo)?void 0:s.roles)||[])),localStorage.setItem("tea_permissions",JSON.stringify((null==(a=l.userInfo)?void 0:a.permissions)||[])),localStorage.setItem("tea_user",JSON.stringify(l.userInfo||{})),g.success("登录成功"),k.push("/dashboard")):(console.error("Invalid login response:",l),g.error("登录失败：无效的响应格式"))}catch(r){console.error("Login error:",r),g.error((null==(o=null==(l=null==r?void 0:r.response)?void 0:l.data)?void 0:o.detail)||"登录失败，请检查账号密码")}finally{h.value=!1}};return(e,a)=>{const l=r("el-input"),o=r("el-form-item"),g=r("el-icon"),w=r("el-button"),k=r("el-form");return n(),t("div",f,[a[7]||(a[7]=i("div",{class:"bg-layer"},null,-1)),i("div",v,[a[6]||(a[6]=i("div",{class:"header"},[i("img",{src:s,alt:"Logo",class:"logo-img"}),i("h1",{class:"app-name"},"茶智云"),i("p",{class:"app-slogan"},"智慧茶园数字大脑")],-1)),u(k,{class:"login-form"},{default:d((()=>[u(o,null,{default:d((()=>[u(l,{modelValue:y.username,"onUpdate:modelValue":a[0]||(a[0]=s=>y.username=s),placeholder:"请输入账号","prefix-icon":"User",class:"custom-input"},null,8,["modelValue"])])),_:1}),u(o,null,{default:d((()=>[u(l,{modelValue:y.password,"onUpdate:modelValue":a[1]||(a[1]=s=>y.password=s),type:"password",placeholder:"请输入密码","prefix-icon":"Lock","show-password":"",class:"custom-input"},null,8,["modelValue"])])),_:1}),u(w,{type:"primary",class:"login-btn",loading:h.value,onClick:I},{default:d((()=>[a[4]||(a[4]=c(" 立即进入 ",-1)),u(g,{class:"ml-2"},{default:d((()=>[u(p(m))])),_:1})])),_:1},8,["loading"]),i("div",_,[i("span",{class:"link-text",onClick:a[2]||(a[2]=s=>e.$router.push("/login/forget"))},"忘记密码"),a[5]||(a[5]=i("span",{class:"link-divider"},"|",-1)),i("span",{class:"link-text",onClick:a[3]||(a[3]=s=>e.$router.push("/login/register"))},"注册账号")])])),_:1})])])}},__scopeId:"data-v-215049f4"};export{w as default};
